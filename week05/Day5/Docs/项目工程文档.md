## 项目三：SVG编辑器作业工程文档

### 一、项目流程

项目的大致交互流程如下所示：

<img src="https://cos-1301609895.cos.ap-nanjing.myqcloud.com/KingSummer/clipboard_20220809_051102.png">

使用`QGraphics View`框架，每次绘制图形，通过鼠标点击和移动事件获取鼠标位置，通过起止矩形位置进行图形的绘制

左边工具栏选择对应工具，可以绘制不同图形，通过`图形构建工场`创建对应图形，然后添加至对应画布对象显示

<img src ="https://cos-1301609895.cos.ap-nanjing.myqcloud.com/KingSummer/clipboard_20220809_080023.png">

### 二、项目架构设计

主要是图形类这一块的设计，采用双基类的方式

由于该`QGraphicsView`框架各种图形类接口不统一并且不同图形的性质与属性设置不一致，导致很多接口方法不通用，于是设计双基类的架构

自定义基类中声明一些统一虚方法，子类按需重写

<img src="https://cos-1301609895.cos.ap-nanjing.myqcloud.com/KingSummer/clipboard_20220809_052354.png">

下面介绍几个主要的类：

#### 1、`KGlobalData`类

公共全局数据保存区，保存右侧参数栏的数据，可以进行设置与获取，以及全局使用到的一些枚举类和一些状态

#### 2、`KEditPage`类

继承自`QGraphicsView`，作为绘图的视口

所有图形的处理页面（新建、删除、拉伸、移动等操作），鼠标的移动、点击、释放等事件的判断和处理集中心

#### 3、`KShapeBase`类

图形框架的自定义基类

声明了一些纯虚方法：

- `setNewRect`

  设置绘制矩形区域，由每个子类自己具体实现

- `setFlags`

  设置图形属性集

- `setPen`

  设置画笔，按需设置（例如KText就无需重写设置）

- `setBrush`

  设置画刷

#### 4、`KShapeFactory`类

图形创建工厂类

### 三、项目思考

这次项目使用`QGraphicsView`绘图框架，前期框架的学习和理解比较困难，需要阅读官方文档和不断尝试

通过使用该框架构建项目，在项目进行过程中出现一系列Bug之后的探究，对该框架的树形图形类管理、三类坐标系的关系与转换、以及图形的矩形边界和渲染边界等规则和属性有了一定的认识，是不同类的方法与属性有了一定的了解

并且由于该绘图框架不同图形类的接口不统一，自定义了基类实现双继承体系，同时去探究学习了一下指针转换几种方式

